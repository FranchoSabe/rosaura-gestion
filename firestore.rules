rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    // Función simple para verificar autenticación
    function isAuth() {
      return request.auth != null;
    }
    
    // Función para verificar si es staff (admin o mozo)
    function isStaff() {
      return isAuth() && 
        (request.auth.token.email in ['admin@rosaura.com', 'mozo@rosaura.com']);
    }

    // Reglas para reservas
    match /reservas/{reservaId} {
      // Permitir lectura pública de reservas
      allow read: if true;
      // Cualquiera puede crear una reserva
      allow create: if true;
      // Solo staff puede modificar o eliminar
      allow update, delete: if isStaff();
    }

    // Reglas para clientes
    match /clientes/{clienteId} {
      // Permitir lectura pública de clientes
      allow read: if true;
      // Cualquiera puede registrarse
      allow create: if true;
      // Solo staff puede modificar
      allow update, delete: if isStaff();
    }
  }
} 